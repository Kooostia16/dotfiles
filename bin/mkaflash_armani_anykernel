#!/bin/bash

CUR_DIR=$( pwd )

AnyKernel=/home/thewisenerd/works/AnyKernel2_armani/

cd ${AnyKernel}

rm -rf workspace
rm -rf unpack
rm -rf boot_new.img

cd ${CUR_DIR}
lesser_modules
dtbTool2 -o dt.img -s 2048 -p scripts/dtc/ arch/arm/boot/
mkdir -p releases
cd ${AnyKernel}

mv /home/thewisenerd/works/kernel_armani/workspace/zImage ./zImage
mv /home/thewisenerd/works/kernel_armani/dt.img           ./dtb

rm -rf modules

rm ./modules/placeholder

mv /home/thewisenerd/works/kernel_armani/workspace/modules ./modules


zip -r9 UPDATE-AnyKernel2.zip * -x .git README UPDATE-AnyKernel2.zip

rm -rf flashable/modules
rm -rf flashable/system
rm -rf flashable/boot.img

rm -rf workspace
rm -rf /home/thewisenerd/works/kernel_armani/workspace/

mkdir -p releases
mv UPDATE-AnyKernel2.zip ${CUR_DIR}/releases/output_`date +%d_%b_%Y`.zip


rm -rf ./modules/placeholder
mkdir -p modules
touch ./modules/placeholder

git clean -f -x -d
git reset --hard

cd ${CUR_DIR}



echo OUTPUT: releases/output_`date +%d_%b_%Y`.zip
